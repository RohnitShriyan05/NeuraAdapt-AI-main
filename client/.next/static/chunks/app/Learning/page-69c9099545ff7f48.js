(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[777],{6812:(e,t,a)=>{Promise.resolve().then(a.bind(a,9320))},9320:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});var s=a(5155),l=a(2115),i=a(9509);function r(){var e,t,a,r,o;let[n,d]=(0,l.useState)(null),[c,x]=(0,l.useState)(!1),[m,u]=(0,l.useState)(null),[g,h]=(0,l.useState)(null),[f,b]=(0,l.useState)(!1),[v,p]=(0,l.useState)(null),j=(0,l.useRef)(null),y=(0,l.useRef)(null),[N,w]=(0,l.useState)(null),k=i.env.NEXT_PUBLIC_API_BASE||"http://localhost:5000";(0,l.useEffect)(()=>()=>{N&&N.getTracks().forEach(e=>e.stop()),n&&URL.revokeObjectURL(n)},[N,n]);let C=async e=>{if(!e.type.startsWith("video/")){u("Please upload a video file");return}let t=URL.createObjectURL(e);d(t),h(e),p(null),u(null);try{let e=await navigator.mediaDevices.getUserMedia({video:!0});w(e),y.current.srcObject=e,j.current&&(j.current.src=t,j.current.load(),j.current.play().catch(e=>{u("Click the video to start playback")}))}catch(e){u("Please allow camera access to continue")}},_=async()=>{if(!g){u("Select a video before analyzing");return}b(!0),u(null);try{let e=new FormData;e.append("video",g);let t=await fetch("".concat(k,"/analyze"),{method:"POST",body:e});if(!t.ok){let e=await t.json();throw Error(e.error||"Analysis failed")}let a=await t.json();p(a)}catch(e){u(e.message||"Analysis failed")}finally{b(!1)}},D=(e,t)=>{e.preventDefault(),x(t)};return(0,s.jsxs)("div",{className:"min-h-screen bg-[#f9fbff] font-open-dyslexic",children:[!n&&(0,s.jsx)("div",{className:"fixed inset-0 flex items-center justify-center transition-colors ".concat(c?"bg-blue-50":"bg-[#f9fbff]"),onDragOver:e=>D(e,!0),onDragLeave:e=>D(e,!1),onDrop:e=>{e.preventDefault(),D(e,!1),e.dataTransfer.files[0]&&C(e.dataTransfer.files[0])},children:(0,s.jsx)("div",{className:"text-center p-8 max-w-2xl",children:(0,s.jsxs)("div",{className:"p-12 rounded-3xl transition-all ".concat(c?"bg-gradient-to-br from-blue-100 to-indigo-100 border-4 border-dashed border-blue-400":"bg-white border-2 border-gray-200 shadow-xl"),children:[(0,s.jsx)("h2",{className:"text-4xl font-bold mb-6 bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:"Upload Learning Material"}),(0,s.jsx)("p",{className:"text-xl text-gray-600 mb-8",children:"Drag and drop video file or click to browse supported formats"}),(0,s.jsx)("input",{type:"file",id:"file-input",className:"hidden",accept:"video/*",onChange:e=>{var t;return(null===(t=e.target.files)||void 0===t?void 0:t[0])&&C(e.target.files[0])}}),(0,s.jsx)("label",{htmlFor:"file-input",className:"px-8 py-3 bg-gradient-to-br from-blue-500 to-indigo-600 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transition-shadow cursor-pointer",children:"Choose Video File"}),m&&(0,s.jsx)("div",{className:"mt-6 px-4 py-2 bg-red-100 text-red-600 rounded-lg",children:m})]})})}),n&&(0,s.jsxs)("div",{className:"relative h-screen bg-gradient-to-br from-gray-50 to-indigo-50",children:[(0,s.jsx)("div",{className:"h-full w-full flex items-center justify-center p-8",children:(0,s.jsx)("video",{ref:j,controls:!0,className:"w-full max-w-6xl rounded-2xl shadow-2xl bg-white",onClick:e=>e.target.play()})}),(0,s.jsx)("div",{className:"absolute bottom-10 left-8 flex flex-col gap-3",children:(0,s.jsx)("button",{className:"bg-blue-600 text-white text-lg px-5 py-3 rounded-md font-semibold shadow-lg disabled:opacity-60",onClick:_,disabled:f,children:f?"Analyzing...":"Analyze Engagement"})}),(0,s.jsxs)("div",{className:"absolute bottom-8 right-8 w-80 aspect-video rounded-xl bg-white shadow-2xl border-2 border-indigo-50 overflow-hidden transition-transform hover:scale-105 hover:shadow-2xl group",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/20 to-indigo-600/20"}),(0,s.jsx)("video",{ref:y,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"}),(0,s.jsx)("div",{className:"absolute bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-black/60 to-transparent",children:(0,s.jsxs)("h3",{className:"text-white font-semibold text-lg flex items-center gap-2 text-sm",children:[(0,s.jsx)("span",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center",children:"\uD83D\uDC41️"}),"Cognitive Engagement Monitor"]})})]}),m&&(0,s.jsxs)("div",{className:"absolute top-8 left-8 px-6 py-3 bg-red-100 text-red-600 rounded-lg flex items-center gap-3",children:[(0,s.jsx)("span",{children:"⚠️"}),m]}),v&&(0,s.jsxs)("div",{className:"absolute top-8 right-8 w-96 bg-white shadow-2xl rounded-2xl p-6 space-y-4 border border-indigo-50",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-indigo-900",children:"Engagement Summary"}),(0,s.jsxs)("div",{className:"text-sm text-gray-600",children:["Avg engagement: ",null===(t=v.summary)||void 0===t?void 0:null===(e=t.avg_engagement)||void 0===e?void 0:e.toFixed(2)]}),(0,s.jsxs)("div",{className:"text-sm text-gray-600",children:["Confusion events: ",null===(a=v.summary)||void 0===a?void 0:a.confusion_events]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"text-sm font-semibold text-indigo-900",children:"Heatmap"}),(0,s.jsx)("div",{className:"grid grid-cols-12 gap-1",children:null===(r=v.heatmap)||void 0===r?void 0:r.slice(0,48).map((e,t)=>(0,s.jsx)("div",{className:"h-3 rounded",style:{backgroundColor:"rgba(59, 130, 246, ".concat(Math.min(1,e.avg_engagement+.2),")")},title:"".concat(e.start.toFixed(1),"s - ").concat(e.end.toFixed(1),"s")},t))})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"text-sm font-semibold text-indigo-900",children:"Notes"}),(0,s.jsx)("div",{className:"max-h-40 overflow-y-auto space-y-2 text-xs text-gray-600",children:null===(o=v.notes)||void 0===o?void 0:o.map((e,t)=>(0,s.jsxs)("div",{className:"p-2 bg-indigo-50 rounded",children:[(0,s.jsxs)("div",{className:"font-semibold",children:[e.timestamp.toFixed(1),"s"]}),(0,s.jsx)("div",{children:e.text})]},t))})]})]})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(6812)),_N_E=e.O()}]);